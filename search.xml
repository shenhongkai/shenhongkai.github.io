<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>iOS NSUInteger 运算问题</title>
    <url>/2022/03/21/iOS%20NSUInteger%20%E8%BF%90%E7%AE%97%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h2 id="iOS-NSUInteger-运算问题"><a href="#iOS-NSUInteger-运算问题" class="headerlink" title="iOS NSUInteger 运算问题"></a>iOS NSUInteger 运算问题</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>iOS中当NSUInteger参与运算时,一定要注意数值的取值范围。当表达式中存在有符号类型和无符号类型时全部的操做数都自动转换为无符号类型。</p>
<span id="more"></span>

<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>例如在下面场景中,数组的count是无符号数据NSUInteger,遍历中idx的单位也是无符号数据NSUInteger。</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">  </span><br><span class="line"><span class="built_in">NSArray</span> *arr1 = @[<span class="string">@&quot;a&quot;</span>];</span><br><span class="line"><span class="built_in">NSArray</span> *arr2 = @[<span class="string">@&quot;1&quot;</span>,<span class="string">@&quot;2&quot;</span>,<span class="string">@&quot;3&quot;</span>];</span><br><span class="line"></span><br><span class="line">[arr2 enumerateObjectsUsingBlock:^(<span class="type">id</span>  _Nonnull obj, <span class="built_in">NSUInteger</span> idx, <span class="type">BOOL</span> * _Nonnull stop) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((arr1.count-idx) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;大于等于0&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;小于0&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果两者都是 NSInteger 有符号数据类型,那么arr1.count &#x3D; 1 , idx 分别为0,1,2, 所有(arr1.count-idx) 的值对应为1,0,-1, 所以打印结果应该为:</p>
<p>大于等于0</p>
<p>大于等于0</p>
<p>小于0</p>
<p>实际上,当arr1.count和idx的单位均为无符号数据NSUInteger时,打印结果为:<br><img src="https://raw.githubusercontent.com/shenhongkai/PicGo/main/2022-03-21-2.png" alt="2022-03-21-2"></p>
<p>从打印结果可以看到,当idx为2时,(arr1.count-idx)的结果以补码的方式转为了无符号类型的数值18446744073709551615。</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>有符号NSUInteger数据类型参与运算时,一定要注意数值的取值范围不能是负数,当为表达式结果为负数时,会以补码的形式转换数值结果。</p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>小知识</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS暗夜模式适配实操</title>
    <url>/2022/03/16/iOS%E6%9A%97%E5%A4%9C%E6%A8%A1%E5%BC%8F%E9%80%82%E9%85%8D%E5%AE%9E%E6%93%8D/</url>
    <content><![CDATA[<p>三个部分<br>1 颜色监听<br>2 图片<br>3 测试啊</p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>暗夜模式</tag>
      </tags>
  </entry>
</search>
